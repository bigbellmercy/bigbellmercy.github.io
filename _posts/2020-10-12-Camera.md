---
title: "/ROS에서 카메라 사용 방법"
date: 2020-10-12 13:53:00 +09:00
categories: ROS
---

# 목적
ROS에서 카메라 사용하는 방법.

# 실행 환경
아래 방법은 다음의 실행 환경에서 수행되었습니다.   
1) X86 Ubuntu 18.04, ROS melodic, realsense SDK, realsense ROS wrapper, D435i depth camera, L515 lidar camera   
2) Jetson Nano, Ubuntu 18.04
실행 환경이 다를 경우 아래 방법이 잘 되지 않을 수도 있습니다.

# ROS에서 USB 카메라 영상 출력하기
1. usb_cam을 설치합니다.
2. `roscd usb_cam`명령으로 usb_cam 폴더로 가서 launch 폴더 밑의 usb_cam.launch 파일을 수정합니다.
- `image_width`와 `image_height`를 카메라 해상도에 맞게 수정합니다.
- `pixel_format`을 uyvy나 yuyv 등 맞게 설정합니다.
- 필요시, `video_device` 등을 수정합니다.
3. USB 카메라를 연결하고 usb_cam을 실행합니다.
> roslaunch usb_cam usb_cam.launch
4. `rqt_image_view`를 실행하면 카메라 영상이 화면에 나타납니다.

# USB 카메라 교정하기 Camera calibration
참고: http://wiki.ros.org/camera_calibration/Tutorials/MonocularCalibration   
준비물: 체커 보드 checker board. 아래 경로의 파일을 받아서 인쇄하고 딱딱한 판에 붙입니다 (사각형은 9x7개이고 내부의 점들은 8x6이 됩니다).
http://wiki.ros.org/camera_calibration/Tutorials/MonocularCalibration?action=AttachFile&do=view&target=check-108.pdf
1. USB 카메라를 연결하고 usb_cam을 실행합니다.
> rosrun usb_cam usb_cam.launch
2. 아래의 명령을 실행하면 창이 나타나고 거기에 카메라 영상이 나타납니다. 화면이 작으면 크기를 조정합니다.
> rosrun camera_calibration cameracalibrator.py --size 8x6 --square 0.035 image:=/usb_cam/image_raw camera:=/usb_cam
3. 카메라 영상에 체크 보드가 나타나게 하고, 체크 보드를 여러 자세와 위치로 계속 움직이면, CALIBCALIBRATE 단추가 활성화 됩니다.
4. CALIBRATE 단추를 누르고 기다리면 창이 멎었다가 회복됩니다.
5. COMMIT 단추를 누르면 교정 결과가 usb_cam에 적용 저장됩니다.
6. SAVE 단추를 누르면 /tmp/calibrationdata.tar.gz라는 파일로 교정 결과가 저장됩니다.
7. 위 파일의 압축을 풀면 ost.yaml이 카메라 교정 파일입니다.
8. 이 파일을 필요한 곳에 사용합니다.
